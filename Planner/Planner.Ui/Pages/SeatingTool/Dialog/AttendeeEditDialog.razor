@using Planner.Data.Models

<MudCard>
    <MudStack Class="m-4" Spacing="3">
        <MudTextField @bind-Value="Attendee.NickName" Label="Nickname"/>
        <MudTextField @bind-Value="Attendee.FirstName" Label="Vorname"/>
        <MudSelect @bind-Value="Attendee.NumberOfSeats" Label="Anzahl Seats">
            <MudSelectItem Value="1"/>
            <MudSelectItem Value="2"/>
        </MudSelect>
        <MudStack>
            <MudSelect @bind-Value="@Attendee.LeftSeat" Label="@FirstSeatTitle">
                <MudSelectItem Value="@("Beginner")"/>
                <MudSelectItem Value="@("Expert")"/>
            </MudSelect>
            <MudSelect @bind-Value="@Attendee.RightSeat" Label="Rechter Seat" Style="@SecondSeatVisible">
                <MudSelectItem Value="@("Beginner")"/>
                <MudSelectItem Value="@("Expert")"/>
            </MudSelect>
            <MudCheckBox T="bool" @bind-Checked="Attendee.IsLegend" Style="@CanBeLegend">
                Legend Upgrade
            </MudCheckBox>
        </MudStack>
        <MudStack>
            <MudSelect @bind-Value="Attendee.MemberGroup" Label="Gruppierung">
                @foreach (var group in Groups)
                {
                    <MudSelectItem Value="@(group)"/>
                }
            </MudSelect>
        </MudStack>
        <MudStack Row="true" Class="mt-3" Justify="Justify.SpaceBetween">
            <MudButton OnClick="@Cancel" Color="Color.Error">Abbrechen</MudButton>
            <MudButton OnClick="@Ok" Color="Color.Success">Ok</MudButton>
        </MudStack>
    </MudStack>
</MudCard>

@code {

    [CascadingParameter] MudDialogInstance MudDialog { get; set; }

    [Parameter]
    public Attendee Attendee { get; set; }

    public string FirstSeatTitle => Attendee.NumberOfSeats > 1 ? "Linker Seat" : "Seat Typ";

    public string SecondSeatVisible => Attendee.NumberOfSeats > 1 ? "" : "display: none";

    public string CanBeLegend
    {
        get
        {
            if (Attendee.NumberOfSeats <= 1) return "display:none;";
            if (Attendee.LeftSeat != "Expert" && Attendee.RightSeat != "Expert") return "display:none;";
            
            return "";
        }
        
    }
    
    private void Cancel()
    {
        MudDialog.Cancel();
    }

    private void Ok()
    {
        MudDialog.Close(DialogResult.Ok(Attendee));
    }

    private List<string> Groups => new()
    {
        "A",
        "B",
        "C",
        "D",
        "E",
        "F",
        "G",
        "H",
        "I",
        "J",
        "K",
        "L",
    };

    private void LeftSeatUpdated(string e)
    {
        Attendee.LeftSeat = e;
        InvokeAsync(StateHasChanged);
    }

    private void RightSeatUpdated(string e)
    {
        Attendee.RightSeat = e;
        InvokeAsync(StateHasChanged);
    }

}